{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ShotList",
  "description": "Film-ready shot breakdown. Schema version 1.0.0.",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "schema_id",
    "schema_version",
    "created_at",
    "script_id",
    "shotlist_id",
    "shots",
    "timing_lock_hash",
    "total_duration_sec"
  ],
  "properties": {
    "created_at": {
      "type": "string"
    },
    "episode_id": {
      "type": [
        "string",
        "null"
      ]
    },
    "metadata": {
      "type": "object"
    },
    "schema_id": {
      "type": "string"
    },
    "schema_version": {
      "type": "string",
      "const": "1.0.0"
    },
    "script_id": {
      "type": "string"
    },
    "shotlist_id": {
      "type": "string"
    },
    "shots": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/Shot"
      }
    },
    "timing_lock_hash": {
      "type": "string"
    },
    "total_duration_sec": {
      "type": "number"
    }
  },
  "$defs": {
    "Shot": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "audio_intent",
        "camera_framing",
        "camera_movement",
        "duration_sec",
        "scene_id",
        "shot_id"
      ],
      "properties": {
        "action_beat": {
          "type": "string"
        },
        "audio_intent": {
          "$ref": "#/$defs/AudioIntent"
        },
        "background_id": {
          "type": [
            "string",
            "null"
          ],
          "description": "References bg_id in AssetManifest_draft.backgrounds[]. The plan builder resolves this to background_asset_id in RenderPlan.shots[] via the two-step lookup: ShotList.background_id → AssetManifest_draft.backgrounds[bg_id].asset_id → RenderPlan.RenderedShot.background_asset_id. Multiple shots may share the same background_id when they occur in the same location."
        },
        "camera_framing": {
          "type": "string"
        },
        "camera_movement": {
          "type": "string"
        },
        "characters": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/CharacterInShot"
          }
        },
        "duration_sec": {
          "type": "number"
        },
        "emotional_tag": {
          "type": [
            "string",
            "null"
          ]
        },
        "environment_notes": {
          "type": "string"
        },
        "scene_id": {
          "type": "string"
        },
        "shot_id": {
          "type": "string"
        },
        "shot_template_id": {
          "type": [
            "string",
            "null"
          ]
        }
      }
    },
    "AudioIntent": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "music_mood": {
          "type": [
            "string",
            "null"
          ]
        },
        "sfx_tags": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "vo_item_ids": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Ordered list of item_id values from AssetManifest_draft.vo_items[] assigned to this shot. All listed IDs are carried into RenderPlan.shots[].vo_lines[] with timeline offsets distributed evenly across the shot duration (Phase 0). Use an empty array when the shot has no VO. Replaces the deprecated vo_item_id field."
        },
        "vo_item_id": {
          "type": [
            "string",
            "null"
          ],
          "description": "DEPRECATED — use vo_item_ids (array) instead. Single item_id from AssetManifest_draft.vo_items[]. Retained for backward compatibility with ShotLists produced before vo_item_ids was introduced. Plan builders should prefer vo_item_ids; if only vo_item_id is present, treat it as vo_item_ids: [vo_item_id]."
        },
        "sfx_item_ids": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Ordered list of item_id values from AssetManifest_draft.sfx_items[] for this shot. One entry per sfx_tag. Format: 'sfx-{shot_id}-{NNN}' (NNN zero-padded). Use an empty array when the shot has no SFX. Carried into RenderPlan.shots[].sfx_asset_ids[] by the plan builder."
        },
        "music_item_id": {
          "type": [
            "string",
            "null"
          ],
          "description": "item_id from AssetManifest_draft.music_items[] for this shot's background music. Format: 'music-{shot_id}'. Null when music_mood is null. Carried into RenderPlan.shots[].music_asset_id by the plan builder."
        },
        "vo_speaker_id": {
          "type": [
            "string",
            "null"
          ]
        },
        "vo_text": {
          "type": [
            "string",
            "null"
          ]
        }
      }
    },
    "CharacterInShot": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "character_id"
      ],
      "properties": {
        "character_id": {
          "type": "string"
        },
        "expression": {
          "type": [
            "string",
            "null"
          ]
        },
        "pose": {
          "type": [
            "string",
            "null"
          ]
        }
      }
    }
  }
}
